
# Vulnerability Report

I identified potential security vulnerabilities in horghmokkula/software-project.

I am committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues.

If at any point you have concerns or questions about this process, please do not hesitate to reach out to me at miruna.calciu@student.laurea.fi . 

If you are _NOT_ the correct point of contact for this report, please let me know!

## Summary

Insecure image handling in the application allows users to upload and retrieve image files without validation. This can lead to unauthorized file access, server-side injection attacks, or even remote code execution if executable content is disguised and served.

## Product

horghmokkula/software-project

## Tested Version

Latest commit as of May 2025

## Details

The image upload and retrieval functionality lacks basic validation or security measures. Uploaded image files are saved to disk and accessed via routes like `/display/<filename>`, without checking:

- File type or MIME
- Path traversal in filename
- File size or extension
- Potentially malicious content in image metadata, which represents high risks.

Example vulnerable code:

```python
@app.route('/display/<filename>')
def display_image(filename):
    return redirect(url_for('static', filename='uploads/' + filename), code=301)
```

## PoC

1. Upload a file named `../../../etc/passwd` disguised as an image.
2. Request `/display/../../../etc/passwd`.
3. Depending on server config, you may access restricted files or poison the content served.

## Impact

This could allow:
- Arbitrary file read or overwrite
- JavaScript injection (if images are served inline)
- Distribution of malware
- Server-side RCE if improperly validated content is interpreted

## Remediation

- Strictly validate file type and extension (e.g., `.png`, `.jpg`)
- Sanitize filenames with `secure_filename()`
- Disallow directory traversal patterns (`../`)
- Limit file size
- Consider serving static files from a separate domain or sandboxed context

## GitHub Security Advisories

If possible, please could you create a private [GitHub Security Advisory](https://help.github.com/en/github/managing-security-vulnerabilities/creating-a-security-advisory) for these findings? This allows you to invite me to collaborate and further discuss these findings in private before they are [published](https://help.github.com/en/github/managing-security-vulnerabilities/publishing-a-security-advisory). I will be happy to collaborate with you, and review your fix to make sure that all corner cases are covered. 
When you use a GitHub Security Advisory, you can request a CVE identification number from GitHub. GitHub usually reviews the request within 72 hours, and the CVE details will be published after you make your security advisory public. Publishing a GitHub Security Advisory and a CVE will help notify the downstream consumers of your project, so they can update to the fixed version.

## Credit

Reported by Miruna Simona Calciu and using AI to better identify and solve issues.

## Contact

miruna.calciu@student.laurea.fi

## Disclosure Policy

The Best Team on Planet research team is dedicated to working closely with the open source community and with projects that are affected by a vulnerability, in order to protect users and ensure a coordinated disclosure. When we identify a vulnerability in a project, we will report it by contacting the publicly-listed security contact for the project if one exists; otherwise we will attempt to contact the project maintainers directly.

If the project team responds and agrees the issue poses a security risk, we will work with the project security team or maintainers to communicate the vulnerability in detail, and agree on the process for public disclosure. Responsibility for developing and releasing a patch lies firmly with the project team, though we aim to facilitate this by providing detailed information about the vulnerability.

Our disclosure deadline for publicly disclosing a vulnerability is: 90 days after the first report to the project team.

We **appreciate the hard work** maintainers put into fixing vulnerabilities and understand that sometimes more time is required to properly address an issue. We want project maintainers to succeed and because of that we are always open to discuss our disclosure policy to fit your specific requirements, when warranted.
